{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"54906","self":"http://jira.codehaus.org/rest/api/latest/issue/54906","key":"PLXCOMP-83","fields":{"progress":{"progress":0,"total":0},"summary":"incorrect URL reported from failures in WebDAV","timetracking":{},"issuetype":{"self":"http://jira.codehaus.org/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"http://jira.codehaus.org/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"customfield_10110":null,"votes":{"self":"http://jira.codehaus.org/rest/api/2/issue/PLXCOMP-83/votes","votes":1,"hasVoted":false},"resolution":null,"fixVersions":[],"resolutiondate":null,"customfield_10210":"3.0","timespent":null,"reporter":{"self":"http://jira.codehaus.org/rest/api/2/user?username=brettporter","name":"brettporter","emailAddress":"brett@apache.org","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Brett Porter","active":true},"aggregatetimeoriginalestimate":null,"customfield_10161":["brettporter(brettporter)","joakime(joakime)","rastaman(rastaman)"],"customfield_10160":null,"updated":"2008-02-23T22:20:23.649-0600","created":"2007-08-10T04:18:34.203-0500","description":"eg. hit a URL that doesn't exist. The HTML response resembles:\n\nResource in error: http://localhost:8080/archiva/repository/org/codehaus/cargo/cargo-ant/0.8/cargo-ant-0.8.jar/org/codehaus/cargo/cargo-ant/0.8/cargo-ant-0.8.jar\n\nNote that the path is incorrect - it is appended again after .jar","priority":{"self":"http://jira.codehaus.org/rest/api/2/priority/3","iconUrl":"http://jira.codehaus.org/images/icons/priorities/major.png","name":"Major","id":"3"},"duedate":null,"issuelinks":[],"customfield_10163":"222307200","watches":{"self":"http://jira.codehaus.org/rest/api/2/issue/PLXCOMP-83/watchers","watchCount":0,"isWatching":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"subtasks":[],"status":{"self":"http://jira.codehaus.org/rest/api/2/status/4","description":"This issue was once resolved, but the resolution was deemed incorrect. From here issues are either marked assigned or resolved.","iconUrl":"http://jira.codehaus.org/images/icons/statuses/reopened.png","name":"Reopened","id":"4"},"customfield_10090":null,"labels":[],"workratio":-1,"assignee":null,"attachment":[{"self":"http://jira.codehaus.org/rest/api/2/attachment/31527","id":"31527","filename":"extended_dav_transaction.txt","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=rastaman","name":"rastaman","emailAddress":"ludovic.maitre@free.fr","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Ludovic Maître","active":true},"created":"2007-12-30T05:56:47.861-0600","size":7575,"mimeType":"text/plain","content":"http://jira.codehaus.org/secure/attachment/31527/extended_dav_transaction.txt"},{"self":"http://jira.codehaus.org/rest/api/2/attachment/29921","id":"29921","filename":"PLXCOMP-83-request-404-bad-repo-id.jpg","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=joakime","name":"joakime","emailAddress":"joakim@erdfelt.net","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Joakim Erdfelt","active":true},"created":"2007-10-15T15:48:41.029-0500","size":45881,"mimeType":"image/jpeg","content":"http://jira.codehaus.org/secure/attachment/29921/PLXCOMP-83-request-404-bad-repo-id.jpg","thumbnail":"http://jira.codehaus.org/secure/thumbnail/29921/_thumb_29921.png"},{"self":"http://jira.codehaus.org/rest/api/2/attachment/29922","id":"29922","filename":"PLXCOMP-83-request-404-bad-resource.jpg","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=joakime","name":"joakime","emailAddress":"joakim@erdfelt.net","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Joakim Erdfelt","active":true},"created":"2007-10-15T15:49:15.080-0500","size":116359,"mimeType":"image/jpeg","content":"http://jira.codehaus.org/secure/attachment/29922/PLXCOMP-83-request-404-bad-resource.jpg","thumbnail":"http://jira.codehaus.org/secure/thumbnail/29922/_thumb_29922.png"}],"customfield_10221":null,"customfield_10220":null,"customfield_10200":null,"aggregatetimeestimate":null,"customfield_10190":null,"project":{"self":"http://jira.codehaus.org/rest/api/2/project/11440","id":"11440","key":"PLXCOMP","name":"Plexus Components","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/projectavatar?size=xsmall&pid=11440&avatarId=10011","24x24":"http://jira.codehaus.org/secure/projectavatar?size=small&pid=11440&avatarId=10011","32x32":"http://jira.codehaus.org/secure/projectavatar?size=medium&pid=11440&avatarId=10011","48x48":"http://jira.codehaus.org/secure/projectavatar?pid=11440&avatarId=10011"},"projectCategory":{"self":"http://jira.codehaus.org/rest/api/2/projectCategory/10003","id":"10003","description":"various containers","name":"containers"}},"versions":[],"customfield_10170":null,"environment":null,"timeestimate":null,"customfield_10130":null,"aggregateprogress":{"progress":0,"total":0},"lastViewed":null,"components":[{"self":"http://jira.codehaus.org/rest/api/2/component/12584","id":"12584","name":"plexus-webdav"}],"comment":{"startAt":0,"maxResults":9,"total":9,"comments":[{"self":"http://jira.codehaus.org/rest/api/2/issue/54906/comment/109711","id":"109711","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=joakime","name":"joakime","emailAddress":"joakim@erdfelt.net","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Joakim Erdfelt","active":true},"body":"Tested with bogus artifact - http://localhost:8080/archiva/repository/internal/foo/fletch/bar/two/0.8/two-0.8.jar\r\n\r\nMonitored the connection with [Wireshark|http://www.wireshark.org].\r\nWhen a resource is requested that doesn't exist, only the 404 is returned.\r\n\r\n{noformat}\r\n  HTTP/1.1 404 Not Found\r\n  Date: Fri, 12 Oct 2007 01:33:40 GMT\r\n  Server: Jetty/5.1.10 (Linux/2.6.17-10-server i386 java/1.5.0_08\r\n  DAV: 1\r\n  MS-Author-Via: DAV\r\n  Content-Type: text/html; charset=\"UTF-8\"\r\n  Connection: close\r\n{noformat}\r\n\r\nNo other content is returned form archiva on that TCP connection.\r\nThis isn't a problem on the archiva side.\r\n","updateAuthor":{"self":"http://jira.codehaus.org/rest/api/2/user?username=joakime","name":"joakime","emailAddress":"joakim@erdfelt.net","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Joakim Erdfelt","active":true},"created":"2007-10-11T20:37:23.759-0500","updated":"2007-10-11T20:37:23.759-0500"},{"self":"http://jira.codehaus.org/rest/api/2/issue/54906/comment/109712","id":"109712","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=joakime","name":"joakime","emailAddress":"joakim@erdfelt.net","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Joakim Erdfelt","active":true},"body":"Just noticed that your URL doesn't contain the repository Id, so ...\r\n\r\nTested with http://localhost:8080/archiva/repository/foo/fletch/bar/two/0.8/two-0.8.jar\r\n\r\nThis time i get the following \r\n\r\n{noformat}\r\n  HTTP/1.1 404 %5Bfoo%5D+Not+Found+%28Likely+Unconfigured%29%2E\r\n  Date: Fri, 12 Oct 2007 01:37:28 GMT\r\n  Server: Jetty/5.1.10 (Linux/2.6.17-10-server i386 java/1.5.0_08\r\n  Content-Type: text/html\r\n  Content-Length: 1324\r\n  Connection: keep-alive\r\n{noformat}\r\n\r\nStill not a problem on the archiva side.","updateAuthor":{"self":"http://jira.codehaus.org/rest/api/2/user?username=joakime","name":"joakime","emailAddress":"joakim@erdfelt.net","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Joakim Erdfelt","active":true},"created":"2007-10-11T20:39:01.500-0500","updated":"2007-10-11T20:39:01.500-0500"},{"self":"http://jira.codehaus.org/rest/api/2/issue/54906/comment/109713","id":"109713","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=joakime","name":"joakime","emailAddress":"joakim@erdfelt.net","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Joakim Erdfelt","active":true},"body":"Closing as cannot reproduce.","updateAuthor":{"self":"http://jira.codehaus.org/rest/api/2/user?username=joakime","name":"joakime","emailAddress":"joakim@erdfelt.net","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Joakim Erdfelt","active":true},"created":"2007-10-11T20:39:35.347-0500","updated":"2007-10-11T20:39:35.347-0500"},{"self":"http://jira.codehaus.org/rest/api/2/issue/54906/comment/109862","id":"109862","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=brettporter","name":"brettporter","emailAddress":"brett@apache.org","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Brett Porter","active":true},"body":"try the URL you gave in a browser :)","updateAuthor":{"self":"http://jira.codehaus.org/rest/api/2/user?username=brettporter","name":"brettporter","emailAddress":"brett@apache.org","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Brett Porter","active":true},"created":"2007-10-13T22:13:40.910-0500","updated":"2007-10-13T22:13:40.910-0500"},{"self":"http://jira.codehaus.org/rest/api/2/issue/54906/comment/110006","id":"110006","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=joakime","name":"joakime","emailAddress":"joakim@erdfelt.net","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Joakim Erdfelt","active":true},"body":"Attaching PLXCOMP83-request-404-bad-repo-id.jpg to demonstrate what happens with a bad repository id.","updateAuthor":{"self":"http://jira.codehaus.org/rest/api/2/user?username=joakime","name":"joakime","emailAddress":"joakim@erdfelt.net","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Joakim Erdfelt","active":true},"created":"2007-10-15T15:48:41.035-0500","updated":"2007-10-15T15:48:41.035-0500"},{"self":"http://jira.codehaus.org/rest/api/2/issue/54906/comment/110007","id":"110007","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=joakime","name":"joakime","emailAddress":"joakim@erdfelt.net","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Joakim Erdfelt","active":true},"body":"Attaching PLXCOMP-83-request-404-bad-resource.jpg to demonstrate the bug with a bad resource requested.","updateAuthor":{"self":"http://jira.codehaus.org/rest/api/2/user?username=joakime","name":"joakime","emailAddress":"joakim@erdfelt.net","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Joakim Erdfelt","active":true},"created":"2007-10-15T15:49:15.087-0500","updated":"2007-10-15T15:49:15.087-0500"},{"self":"http://jira.codehaus.org/rest/api/2/issue/54906/comment/110008","id":"110008","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=joakime","name":"joakime","emailAddress":"joakim@erdfelt.net","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Joakim Erdfelt","active":true},"body":"This is an error in the DAVException found within the it.could.webdav implementation.","updateAuthor":{"self":"http://jira.codehaus.org/rest/api/2/user?username=joakime","name":"joakime","emailAddress":"joakim@erdfelt.net","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Joakim Erdfelt","active":true},"created":"2007-10-15T15:54:01.084-0500","updated":"2007-10-15T15:54:01.084-0500"},{"self":"http://jira.codehaus.org/rest/api/2/issue/54906/comment/118199","id":"118199","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=rastaman","name":"rastaman","emailAddress":"ludovic.maitre@free.fr","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Ludovic Maître","active":true},"body":"Hopefully a fix for this issue. ","updateAuthor":{"self":"http://jira.codehaus.org/rest/api/2/user?username=rastaman","name":"rastaman","emailAddress":"ludovic.maitre@free.fr","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Ludovic Maître","active":true},"created":"2007-12-30T05:56:47.873-0600","updated":"2007-12-30T05:56:47.873-0600"},{"self":"http://jira.codehaus.org/rest/api/2/issue/54906/comment/118200","id":"118200","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=rastaman","name":"rastaman","emailAddress":"ludovic.maitre@free.fr","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Ludovic Maître","active":true},"body":"Hi all,\r\n\r\nI guess i found the cause of the error and a fix for it. As i see it the problem come from the lookup() method in class it.could.webdav.DAVTransaction: the base it use to construct the final url delivered to the client is wrong / doesn't match the url used to send in the request. I've modified DAVTransaction to be extensible (private fields -> protected fields) and added a new class ExtendedDAVTransaction which use the prefix of the DAVServerRequest to extract the base path. Below is the javadoc with an illustration of the problem my class resolve (i guess it's the one described in this issue, but perhaps i'm wrong) :\r\n\r\nA DAV transaction which use the DaveServerRequest prefix to build an external URL which match the one given by the client.\r\ni.e with usual transaction the following url given in a propfind \r\nPROPFIND /archiva/repository/ubik-central/com/ubikproducts/svnauthz/ubik-svnauthz/1.0/ \r\nreturn properties for the following href:\r\n     <D:href>\r\n           /archiva/repository/com/ubikproducts/svnauthz/ubik-svnauthz/1.0/com/ubikproducts/svnauthz/ubik-svnauthz/1.0/\r\n     </D:href>\r\nWith this implementation the same url:\r\n PROPFIND /archiva/repository/ubik-central/com/ubikproducts/svnauthz/ubik-svnauthz/1.0/\r\n  return properties for the right href:\r\n     <D:href>\r\n           /archiva/repository/ubik-central/com/ubikproducts/svnauthz/ubik-svnauthz/1.0/\r\n     </D:href>\r\n At least in my setup, with a Tomcat 5.5 java server reverse proxied \r\n by a Apache 2 http server.\r\n \r\nBest regards,\r\nPS: With this fix and the one i will submit soon in wagon-webdav the deployment on archiva works lot better in my setup. \r\n","updateAuthor":{"self":"http://jira.codehaus.org/rest/api/2/user?username=rastaman","name":"rastaman","emailAddress":"ludovic.maitre@free.fr","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Ludovic Maître","active":true},"created":"2007-12-30T06:05:24.772-0600","updated":"2007-12-30T06:05:24.772-0600"}]},"timeoriginalestimate":null,"aggregatetimespent":null}}